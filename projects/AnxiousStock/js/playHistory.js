let liquidationHistory=[],totalProfitLoss=0;function loadLiquidationHistory(){const o=localStorage.getItem("anxiousStock_liquidationHistory"),t=localStorage.getItem("anxiousStock_totalProfitLoss");if(o)try{liquidationHistory=JSON.parse(o)}catch(o){console.error("無法解析清倉歷史記錄:",o),liquidationHistory=[]}if(t)try{totalProfitLoss=parseFloat(t)}catch(o){console.error("無法解析累計損益:",o),totalProfitLoss=0}return liquidationHistory}function saveLiquidationHistory(){try{localStorage.setItem("anxiousStock_liquidationHistory",JSON.stringify(liquidationHistory)),localStorage.setItem("anxiousStock_totalProfitLoss",totalProfitLoss.toFixed(2))}catch(o){console.error("無法保存清倉歷史記錄:",o)}}function recordLiquidation(o){return loadLiquidationHistory(),o.timestamp=(new Date).toISOString(),o.profitLoss=parseFloat(o.profitLoss.toFixed(2)),o.profitLossPercentage=parseFloat(o.profitLossPercentage.toFixed(2)),totalProfitLoss=parseFloat((totalProfitLoss+o.profitLoss).toFixed(2)),liquidationHistory.push({timestamp:o.timestamp,candleCount:o.candleCount,profitLoss:o.profitLoss,profitLossPercentage:o.profitLossPercentage}),liquidationHistory.length>100&&liquidationHistory.shift(),saveLiquidationHistory(),o}function getLiquidationHistory(){return loadLiquidationHistory()}function getTotalProfitLoss(){return loadLiquidationHistory(),totalProfitLoss}function clearLiquidationHistory(){liquidationHistory=[],totalProfitLoss=0,localStorage.removeItem("anxiousStock_liquidationHistory"),localStorage.removeItem("anxiousStock_totalProfitLoss")}export{recordLiquidation,getLiquidationHistory,getTotalProfitLoss,clearLiquidationHistory};