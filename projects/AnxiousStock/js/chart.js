export function generateNewCandle(e,t,a,n){0===e.candles.length&&(t.innerHTML="");const l=e.candles.length>0?e.candles[e.candles.length-1].close:e.stockPrice,c=l*(Math.random()*e.volatility*2-e.volatility),s=Math.max(l+c,1),d={open:l,close:s,high:Math.max(l,s)+Math.random()*Math.abs(c)*.5,low:Math.min(l,s)-Math.random()*Math.abs(c)*.5,timestamp:new Date};e.candles.push(d),e.candles.length>e.maxCandles&&e.candles.shift(),e.stockPrice=s,e.currentValue=e.shares*e.stockPrice,a(),n(e,t)}export function renderChart(e,t){if(0===e.candles.length)return;t.innerHTML="";const a=document.createElement("div");a.className="candlestick-container";let n=1/0,l=-1/0;e.candles.forEach((e=>{n=Math.min(n,e.low),l=Math.max(l,e.high)}));const c=l-n;n=Math.max(0,n-.1*c),l+=.1*c;const s=document.createElement("div");s.className="price-axis";for(let e=0;e<=4;e++){const t=l-e*(l-n)/4,a=document.createElement("div");a.className="price-label",a.textContent=t.toFixed(2),s.appendChild(a)}const d=document.createElement("div");d.className="time-axis";for(let t=0;t<Math.min(5,e.candles.length);t++){const a=Math.floor(t*(e.candles.length-1)/4);if(a<e.candles.length){const t=e.candles[a].timestamp,n=document.createElement("div");n.className="time-label",n.textContent=t.getHours()+":"+String(t.getMinutes()).padStart(2,"0"),d.appendChild(n)}}const o=e.maxCandles-e.candles.length;for(let e=0;e<o;e++){const e=document.createElement("div");e.className="candlestick",a.appendChild(e)}e.candles.forEach(((t,c)=>{const s=document.createElement("div");s.className="candlestick";const d=100/(l-n),o=Math.max(2,Math.abs(t.close-t.open)*d),i=(t.high-t.low)*d,m=(t.low-n)*d,h=document.createElement("div");h.className="candle";let r="no-change";t.close>t.open?r="rise":t.close<t.open&&(r="fall"),h.classList.add(r);const p=document.createElement("div");p.className="wick",p.style.height=i+"%",p.style.bottom=m+"%";const g=document.createElement("div");g.className="body",g.style.height=o+"%",t.close>=t.open?g.style.bottom=(t.open-n)*d+"%":g.style.bottom=(t.close-n)*d+"%",c===e.candles.length-1&&h.classList.add("new-candle"),h.appendChild(p),h.appendChild(g),s.appendChild(h),a.appendChild(s)}));for(let e=0;e<o;e++){const e=document.createElement("div");e.className="candlestick",a.appendChild(e)}a.appendChild(s),a.appendChild(d),t.appendChild(a)}